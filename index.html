<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é«˜è€ƒå¿—æ„¿å¡«æŠ¥æ™ºèƒ½æ¨èç³»ç»Ÿ</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        /* å…¨å±€é‡ç½®å’ŒåŸºç¡€æ ·å¼ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --color-primary: #007AFF; /* Apple Blue */
            --color-secondary: #5AC8FA; /* Lighter Blue */
            --color-accent: #FF9500; /* Orange Accent */
            --color-text-dark: #1C1C1E; /* Dark Text */
            --color-text-light: #8E8E93; /* Light Gray Text */
            --color-background: #F2F2F7; /* Light Background */
            --color-card-bg: #FFFFFF; /* Card Background */
            --color-border: #E5E5EA; /* Border Color */
            --shadow-light: 0 1px 3px rgba(0, 0, 0, 0.08);
            --shadow-medium: 0 4px 12px rgba(0, 0, 0, 0.1);
            --shadow-deep: 0 8px 24px rgba(0, 0, 0, 0.15);
            --border-radius-small: 8px;
            --border-radius-medium: 12px;
            --border-radius-large: 16px;
            
            /* åˆ†ç±»é¢œè‰² */
            --color-rush: #FF3B30; /* Red */
            --color-stable: #34C759; /* Green */
            --color-safe: #FF9500; /* Orange */
            --color-backup: #5856D6; /* Indigo */
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;
            background-color: var(--color-background);
            min-height: 100vh;
            padding: 40px;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            color: var(--color-text-dark);
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .container {
            max-width: 1200px;
            width: 100%;
            margin: 0 auto;
            background: var(--color-card-bg);
            border-radius: var(--border-radius-large);
            box-shadow: var(--shadow-deep);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            border: 1px solid var(--color-border);
        }

        .header {
            background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-secondary) 100%);
            color: white;
            padding: 50px;
            text-align: center;
            position: relative;
            overflow: hidden;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: var(--shadow-light);
        }
        
        /* [ä¼˜åŒ–] é€€å‡ºæŒ‰é’®æ ·å¼å’Œä½ç½®è°ƒæ•´ */
        #logoutBtn {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.4);
            color: white;
            padding: 8px 16px;
            border-radius: var(--border-radius-small);
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 600;
            transition: all 0.3s ease;
            backdrop-filter: blur(5px);
            z-index: 2;
        }

        #logoutBtn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
            box-shadow: var(--shadow-light);
        }


        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle at center, rgba(255,255,255,0.15) 0%, transparent 70%);
            animation: header-pulse 10s infinite alternate;
        }

        @keyframes header-pulse {
            0% { transform: scale(1); opacity: 0.5; }
            100% { transform: scale(1.1); opacity: 0.8; }
        }

        .header h1 {
            font-size: 3rem;
            margin-bottom: 15px;
            font-weight: 800;
            letter-spacing: 1.5px;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
            position: relative;
            z-index: 1;
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
            position: relative;
            z-index: 1;
        }

        .form-section {
            padding: 50px;
            background-color: var(--color-card-bg);
            border-bottom: 1px solid var(--color-border);
        }

        .form-group {
            margin-bottom: 30px;
        }

        .form-group label {
            display: block;
            margin-bottom: 12px;
            font-weight: 700;
            color: var(--color-text-dark);
            font-size: 1.2rem;
        }

        .form-control {
            width: 100%;
            padding: 18px 20px;
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius-medium);
            font-size: 1.1rem;
            transition: all 0.3s ease;
            background: var(--color-background);
            color: var(--color-text-dark);
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
        }

        .form-control::placeholder {
            color: var(--color-text-light);
            opacity: 0.8;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--color-primary);
            background: var(--color-card-bg);
            box-shadow: 0 0 0 4px rgba(0, 122, 255, 0.15);
        }

        .radio-group {
            display: flex;
            gap: 20px;
            margin-top: 15px;
        }

        .radio-option {
            display: flex;
            align-items: center;
            padding: 18px 30px;
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius-medium);
            cursor: pointer;
            transition: all 0.3s ease;
            background: var(--color-background);
            font-size: 1.1rem;
            font-weight: 500;
            color: var(--color-text-dark);
        }

        /* æ–°å¢æ ·å¼ï¼šçœå†…çœå¤–é™¢æ ¡å·¦å³æ’å¸ƒ */
        .schools-container {
            display: flex;
            gap: 20px; /* è°ƒæ•´é—´è· */
            margin-top: 20px;
        }

        .local-schools, .external-schools {
            flex: 1; /* å¹³å‡åˆ†é…å®½åº¦ */
            min-width: 0; /* å…è®¸å†…å®¹ç¼©å° */
        }

        .schools-container h4 {
            font-size: 1.1rem;
            color: var(--color-text-dark);
            margin-bottom: 10px;
            padding-bottom: 5px;
            border-bottom: 1px solid var(--color-border);
        }

        .schools-container .school-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 15px;
        }

        .schools-container .school-table th,
        .schools-container .school-table td {
            padding: 10px;
            border: 1px solid var(--color-border);
            text-align: left;
            vertical-align: top;
        }

        .schools-container .school-table th {
            background-color: var(--color-background);
            font-weight: 600;
        }

        .schools-container .school-table tr:nth-child(odd) {
            background-color: rgba(0, 0, 0, 0.02);
        }

        .schools-container .school-table tr:hover {
            background-color: rgba(0, 122, 255, 0.05);
        }

        .schools-container .school-table td:first-child {
            font-weight: 500;
            color: var(--color-primary);
        }

        /* å“åº”å¼è°ƒæ•´ */
        @media (max-width: 768px) {
            .schools-container {
                flex-direction: column; /* å°å±å¹•ä¸‹å‚ç›´å †å  */
            }
        }
            flex: 1;
            justify-content: center;
        }

        .radio-option:hover {
            border-color: var(--color-primary);
            background: rgba(0, 122, 255, 0.05);
        }

        .radio-option input[type="radio"] {
            margin-right: 12px;
            transform: scale(1.3);
            accent-color: var(--color-primary);
        }

        .radio-option.selected {
            border-color: var(--color-primary);
            background: rgba(0, 122, 255, 0.1);
            color: var(--color-primary);
            box-shadow: var(--shadow-light);
        }

        .submit-btn {
            background: var(--color-primary);
            color: white;
            border: none;
            padding: 20px 45px;
            font-size: 1.25rem;
            font-weight: 700;
            border-radius: var(--border-radius-medium);
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            margin-top: 30px;
            box-shadow: var(--shadow-medium);
            letter-spacing: 1px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .submit-btn:hover {
            background: #005bb5;
            transform: translateY(-3px);
            box-shadow: var(--shadow-deep);
        }

        .submit-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 60px;
            background-color: var(--color-background);
            flex-direction: column;
            align-items: center;
            gap: 25px;
        }

        .spinner {
            border: 6px solid rgba(0, 0, 0, 0.1);
            border-top: 6px solid var(--color-primary);
            border-radius: 50%;
            width: 60px;
            height: 60px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading h3 {
            color: var(--color-text-dark);
            font-size: 1.8rem;
            font-weight: 600;
        }

        .loading p {
            color: var(--color-text-light);
            font-size: 1.1rem;
        }

        .results {
            display: none;
            padding: 50px;
            background: var(--color-background);
        }
        
        /* [æ–°å¢] ç»“æœé¡µé¡¶éƒ¨çš„æ¦‚è¦ä¿¡æ¯å’Œæ“ä½œæŒ‰é’® */
        .results-header {
            background-color: var(--color-card-bg);
            padding: 25px 30px;
            border-radius: var(--border-radius-large);
            margin-bottom: 40px;
            box-shadow: var(--shadow-medium);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
        }
        .results-header-info p {
            font-size: 1.1rem;
            color: var(--color-text-dark);
        }
        .results-header-info span {
            font-weight: 700;
            color: var(--color-primary);
            padding: 4px 8px;
            background-color: rgba(0, 122, 255, 0.1);
            border-radius: var(--border-radius-small);
        }
        .results-header .retry-btn {
            background: var(--color-primary);
            color: white;
            border: none;
            padding: 12px 25px;
            font-size: 1rem;
            font-weight: 600;
            border-radius: var(--border-radius-medium);
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: var(--shadow-light);
        }
        .results-header .retry-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-medium);
        }

        /* [ä¼˜åŒ–] å°†å¤§è¡¨æ ¼æ”¹ä¸ºåˆ†ç±»å¡ç‰‡ */
        .category-card {
            margin-bottom: 40px;
            background: var(--color-card-bg);
            border-radius: var(--border-radius-large);
            box-shadow: var(--shadow-medium);
            overflow: hidden;
            border: 1px solid var(--color-border);
            transition: all 0.3s ease;
        }
        .category-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-deep);
        }

        .category-header {
            padding: 20px 30px;
            border-bottom: 1px solid var(--color-border);
            color: white;
            font-size: 1.8rem;
            font-weight: 700;
        }
        .category-header.rush { background-color: var(--color-rush); }
        .category-header.stable { background-color: var(--color-stable); }
        .category-header.safe { background-color: var(--color-safe); }
        .category-header.backup { background-color: var(--color-backup); }

        .category-content {
            padding: 30px;
        }

        .category-content h4 {
            font-size: 1.3rem;
            margin-bottom: 15px;
            color: var(--color-text-dark);
            border-left: 4px solid var(--color-primary);
            padding-left: 10px;
        }

        .no-data {
            color: var(--color-text-light);
            padding: 20px 0;
        }

        /* [ä¼˜åŒ–] æ¨èé™¢æ ¡è¡¨æ ¼æ ·å¼ */
        .school-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 30px;
        }

        .school-table th, .school-table td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid var(--color-border);
        }

        .school-table th {
            background-color: #f8f8f9;
            color: var(--color-text-dark);
            font-weight: 600;
            font-size: 1rem;
        }

        .school-table td {
            font-size: 1rem;
        }
        
        .school-table td.school-name {
            font-weight: 600;
            color: var(--color-text-dark);
        }
        
        .school-table td.school-desc {
            color: var(--color-text-light);
            line-height: 1.5;
        }
        
        .school-table tbody tr:last-child td {
            border-bottom: none;
        }
        
        .school-table tbody tr:hover {
            background-color: #f9f9f9;
        }

        .error-message {
            background: #FF3B30;
            color: white;
            padding: 15px;
            border-radius: var(--border-radius-medium);
            margin-top: 20px;
            display: none;
            font-weight: 600;
            text-align: center;
            box-shadow: var(--shadow-light);
        }
 
        @media (max-width: 992px) {
            .container {
                border-radius: var(--border-radius-medium);
            }
            .header h1 {
                font-size: 2.5rem;
            }
            .form-section, .results {
                padding: 30px;
            }
            .results-header {
                flex-direction: column;
                align-items: flex-start;
            }
        }
 
        /* [ä¼˜åŒ–] å“åº”å¼è¡¨æ ¼ï¼Œä½¿å…¶åœ¨å°å±å¹•ä¸Šæ›´å¯è¯» */
        @media (max-width: 768px) {
            .school-table thead {
                display: none;
            }

            .school-table tr {
                display: block;
                margin-bottom: 20px;
                border: 1px solid var(--color-border);
                border-radius: var(--border-radius-medium);
                padding: 15px;
                box-shadow: var(--shadow-light);
            }

            .school-table td {
                display: block;
                text-align: left;
                padding: 8px 0;
                border-bottom: none;
            }

            .school-table td::before {
                content: attr(data-label);
                font-weight: 600;
                display: block;
                margin-bottom: 5px;
                color: var(--color-primary);
            }

            .school-table td.school-desc {
                 padding-top: 10px;
                 border-top: 1px dashed var(--color-border);
                 margin-top: 10px;
            }
        }

        @media (max-width: 576px) {
            body {
                padding: 15px;
            }
            .header {
                padding: 30px;
            }
            .header h1 {
                font-size: 2rem;
            }
            .header p {
                font-size: 1rem;
            }
            #logoutBtn {
                top: 15px;
                right: 15px;
            }
            .form-section, .results {
                padding: 20px;
            }
            .form-group label {
                font-size: 1.1rem;
            }
            .form-control, .radio-option {
                padding: 15px;
                font-size: 1rem;
            }
            .radio-group {
                flex-direction: column;
                gap: 15px;
            }
            .submit-btn {
                padding: 18px;
                font-size: 1.1rem;
            }
            .category-header {
                font-size: 1.5rem;
                padding: 15px 20px;
            }
            .category-content {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>ğŸ“ é«˜è€ƒå¿—æ„¿å¡«æŠ¥æ™ºèƒ½æ¨èç³»ç»Ÿ</h1>
            <p>åŸºäºå¤§æ•°æ®ä¸AIï¼Œä¸ºæ‚¨è§„åˆ’æœªæ¥</p>
            <button id="logoutBtn">é€€å‡ºç™»å½•</button>
        </header>
 
        <div class="form-section" id="inputForm">
            <form id="volunteerForm">
                <div class="form-group">
                    <label for="province">è€ƒç”Ÿæ‰€åœ¨çœä»½</label>
                    <select id="province" name="province" class="form-control" required>
                        <option value="">è¯·é€‰æ‹©çœä»½</option>
                        <option value="åŒ—äº¬">åŒ—äº¬</option>
                        <option value="å¤©æ´¥">å¤©æ´¥</option>
                        <option value="æ²³åŒ—">æ²³åŒ—</option>
                        <option value="å±±è¥¿">å±±è¥¿</option>
                        <option value="å†…è’™å¤">å†…è’™å¤</option>
                        <option value="è¾½å®">è¾½å®</option>
                        <option value="å‰æ—">å‰æ—</option>
                        <option value="é»‘é¾™æ±Ÿ">é»‘é¾™æ±Ÿ</option>
                        <option value="ä¸Šæµ·">ä¸Šæµ·</option>
                        <option value="æ±Ÿè‹">æ±Ÿè‹</option>
                        <option value="æµ™æ±Ÿ">æµ™æ±Ÿ</option>
                        <option value="å®‰å¾½">å®‰å¾½</option>
                        <option value="ç¦å»º">ç¦å»º</option>
                        <option value="æ±Ÿè¥¿">æ±Ÿè¥¿</option>
                        <option value="å±±ä¸œ">å±±ä¸œ</option>
                        <option value="æ²³å—">æ²³å—</option>
                        <option value="æ¹–åŒ—">æ¹–åŒ—</option>
                        <option value="æ¹–å—">æ¹–å—</option>
                        <option value="å¹¿ä¸œ">å¹¿ä¸œ</option>
                        <option value="å¹¿è¥¿">å¹¿è¥¿</option>
                        <option value="æµ·å—">æµ·å—</option>
                        <option value="é‡åº†">é‡åº†</option>
                        <option value="å››å·">å››å·</option>
                        <option value="è´µå·">è´µå·</option>
                        <option value="äº‘å—">äº‘å—</option>
                        <option value="è¥¿è—">è¥¿è—</option>
                        <option value="é™•è¥¿">é™•è¥¿</option>
                        <option value="ç”˜è‚ƒ">ç”˜è‚ƒ</option>
                        <option value="é’æµ·">é’æµ·</option>
                        <option value="å®å¤">å®å¤</option>
                        <option value="æ–°ç–†">æ–°ç–†</option>
                    </select>
                </div>
 
                <div class="form-group">
                    <label for="score">é«˜è€ƒåˆ†æ•°</label>
                    <input type="number" id="score" name="score" class="form-control" placeholder="è¯·è¾“å…¥æ‚¨çš„é«˜è€ƒåˆ†æ•°" min="0" max="750" required>
                </div>
 
                <div class="form-group">
                    <label>é€‰è€ƒç§‘ç›®ç±»åˆ«</label>
                    <div class="radio-group">
                        <div class="radio-option">
                            <input type="radio" id="history" name="category" value="å†å²ç±»" required>
                            <label for="history">å†å²ç±»</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="physics" name="category" value="ç‰©ç†ç±»" required>
                            <label for="physics">ç‰©ç†ç±»</label>
                        </div>
                    </div>
                </div>
 
                <button type="submit" class="submit-btn" id="submitBtn">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m12 14 4-4"/><path d="M3.34 19a10 10 0 1 1 17.32 0"/></svg>
                    å¼€å§‹æ™ºèƒ½åˆ†æ
                </button>
            </form>
 
            <div class="error-message" id="errorMessage"></div>
        </div>
 
        <div class="loading" id="loading">
            <div class="spinner"></div>
            <h3>æ­£åœ¨ä¸ºæ‚¨æ™ºèƒ½åˆ†æ...</h3>
            <p>åŸºäºæµ·é‡æ•°æ®å’ŒAIæ¨¡å‹ï¼Œè¯·ç¨å€™ç‰‡åˆ»</p>
        </div>
 
        <div class="results" id="results">
             <!-- [æ–°å¢] ç»“æœæ¸²æŸ“åŒºåŸŸ -->
            <div id="recommendationContent"></div>
        </div>
    </div>
 
    <script>
        // æ£€æŸ¥ç™»å½•çŠ¶æ€
        if (!localStorage.getItem('loggedInUser')) {
            window.location.href = 'login.html';
        }

        // é€€å‡ºç™»å½•åŠŸèƒ½
        document.getElementById('logoutBtn').addEventListener('click', function() {
            localStorage.removeItem('loggedInUser');
            window.location.href = 'login.html';
        });

        const API_CONFIG = {
            url: 'https://api.siliconflow.cn/v1/chat/completions',
            token: 'sk-krdbzigcszscdiazaqdlctqvvnsofncjwggowvewbpjieioo',
            model: 'Qwen/Qwen3-32B'
        };
 
        const form = document.getElementById('volunteerForm');
        const submitBtn = document.getElementById('submitBtn');
        const loading = document.getElementById('loading');
        const results = document.getElementById('results');
        const errorMessage = document.getElementById('errorMessage');
        const inputForm = document.getElementById('inputForm');
 
        document.querySelectorAll('input[name="category"]').forEach(radio => {
            radio.addEventListener('change', function() {
                document.querySelectorAll('.radio-option').forEach(option => {
                    option.classList.remove('selected');
                });
                if (this.checked) {
                    this.closest('.radio-option').classList.add('selected');
                }
            });
        });
 
        form.addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const formData = new FormData(form);
            const province = formData.get('province');
            const score = formData.get('score');
            const category = formData.get('category');
 
            showLoading();
            // [ä¼˜åŒ–] å¹³æ»‘æ»šåŠ¨åˆ°åŠ è½½åŠ¨ç”»
            loading.scrollIntoView({ behavior: 'smooth' });
 
            try {
                const prompt = generatePrompt(province, score, category);
                const recommendation = await getAIRecommendation(prompt);
                displayResults(recommendation, { province, score, category });
                
            } catch (error) {
                showError('åˆ†æè¿‡ç¨‹ä¸­å‡ºç°é”™è¯¯ï¼Œè¯·ç¨åé‡è¯•ã€‚é”™è¯¯ä¿¡æ¯ï¼š' + error.message);
            }
        });
 
        // [ä¼˜åŒ–] æ›´æ–°AIæç¤ºè¯ï¼Œè¦æ±‚æä¾›æ›´ä¸°å¯Œçš„JSONç»“æ„
        function generatePrompt(province, score, category) {
            return `è¯·ä½œä¸ºé«˜è€ƒå¿—æ„¿å¡«æŠ¥ä¸“å®¶ï¼Œä¸ºä»¥ä¸‹è€ƒç”Ÿæä¾›ä¸“ä¸šçš„é™¢æ ¡æ¨èï¼š
 
è€ƒç”Ÿä¿¡æ¯ï¼š
- æ‰€åœ¨çœä»½ï¼š${province}
- é«˜è€ƒåˆ†æ•°ï¼š${score}åˆ†
- é€‰è€ƒç±»åˆ«ï¼š${category}
 
è¯·ä¸¥æ ¼æŒ‰ç…§ä»¥ä¸‹è¦æ±‚å’ŒJSONæ ¼å¼è¾“å‡ºï¼Œä¸è¦æ·»åŠ ä»»ä½•é¢å¤–çš„è§£é‡Šæˆ–è¯´æ˜æ–‡å­—ï¼š
1. æ ¹æ®åˆ†æ•°ï¼Œå°†æ¨èé™¢æ ¡åˆ†ä¸º"å†²åˆºé™¢æ ¡"ã€"ç¨³å¦¥é™¢æ ¡"ã€"ä¿åº•é™¢æ ¡"ã€"å«åº•é™¢æ ¡"å››ä¸ªå±‚æ¬¡ã€‚
2. åœ¨æ¯ä¸ªå±‚æ¬¡å†…ï¼Œå†åˆ†ä¸º"çœå†…"å’Œ"çœå¤–"ä¸¤ä¸ªç±»åˆ«ã€‚
3. æ¯ä¸ªç±»åˆ«æ¨è3-5æ‰€é™¢æ ¡ã€‚
4. å¯¹æ¯æ‰€é™¢æ ¡ï¼Œæä¾›åç§°(name)å’Œä¸€å¥ç®€è¦è¯´æ˜(description)ï¼Œè¯´æ˜å†…å®¹åº”åŒ…å«é™¢æ ¡ç‰¹è‰²æˆ–ä¼˜åŠ¿ä¸“ä¸šã€‚
 
è¾“å‡ºæ ¼å¼ (å¿…é¡»æ˜¯çº¯JSON):
{
  "å†²åˆºé™¢æ ¡": {
    "çœå†…": [
      {"name": "é™¢æ ¡A", "description": "è¯¥æ ¡æ˜¯...ï¼Œå…¶ç‹ç‰Œä¸“ä¸šæ˜¯..."},
      {"name": "é™¢æ ¡B", "description": "ä»¥...é—»åï¼Œé€‚åˆå¯¹...æ„Ÿå…´è¶£çš„è€ƒç”Ÿ"}
    ],
    "çœå¤–": [
      {"name": "é™¢æ ¡C", "description": "ä½äº...ï¼Œæ˜¯...é¢†åŸŸçš„å¼ºæ ¡"},
      {"name": "é™¢æ ¡D", "description": "ä½äºï¼Œ...ç­‰å­¦ç§‘å®åŠ›çªå‡º"}
    ]
  },
  "ç¨³å¦¥é™¢æ ¡": { ... },
  "ä¿åº•é™¢æ ¡": { ... },
  "å«åº•é™¢æ ¡": { ... }
}

è¯·ç¡®ä¿æ¨èçš„é™¢æ ¡çœŸå®å­˜åœ¨ï¼Œå¹¶ä¸”ç¬¦åˆè¯¥çœä»½${category}è€ƒç”Ÿçš„è¿‘å¹´å½•å–æƒ…å†µã€‚`;
        }
 
        async function getAIRecommendation(prompt) {
            const response = await fetch(API_CONFIG.url, {
                method: 'POST',
                headers: {
                    'Authorization': `Bearer ${API_CONFIG.token}`,
                    'Content-Type': 'application/json',
                    'Accept': 'application/json'
                },
                body: JSON.stringify({
                    model: API_CONFIG.model,
                    messages: [{ role: 'user', content: prompt }],
                    temperature: 0.5,
                    max_tokens: 4000,
                    // [æ–°å¢] å¼ºåˆ¶ä½¿ç”¨JSONè¾“å‡ºæ¨¡å¼
                    response_format: { type: "json_object" }
                })
            });
 
            if (!response.ok) {
                const errorBody = await response.text();
                throw new Error(`APIè¯·æ±‚å¤±è´¥: ${response.status} ${response.statusText}. å“åº”ä½“: ${errorBody}`);
            }
 
            const data = await response.json();
            
            if (!data.choices || !data.choices[0] || !data.choices[0].message) {
                throw new Error('APIè¿”å›æ•°æ®æ ¼å¼é”™è¯¯');
            }
 
            return data.choices[0].message.content;
        }
        
        // [é‡æ„] ç»“æœå±•ç¤ºå‡½æ•°ï¼Œå¸ƒå±€æ›´æ¸…æ™°
        function displayResults(recommendation, userInfo) {
            try {
                // [ä¼˜åŒ–] AIè¿”å›çš„å·²ç»æ˜¯çº¯JSONå­—ç¬¦ä¸²ï¼Œå¯ä»¥ç›´æ¥è§£æ
                const data = JSON.parse(recommendation);
                const content = document.getElementById('recommendationContent');
                content.innerHTML = ''; // æ¸…ç©ºæ—§å†…å®¹

                // 1. åˆ›å»ºç»“æœæ¦‚è¦å’Œé‡è¯•æŒ‰é’®
                const resultsHeader = document.createElement('div');
                resultsHeader.className = 'results-header';
                resultsHeader.innerHTML = `
                    <div class="results-header-info">
                        <p>ä¸º <span>${userInfo.province}</span> <span>${userInfo.category}</span> <span>${userInfo.score}åˆ†</span> è€ƒç”Ÿçš„æ¨èç»“æœ</p>
                    </div>
                    <button class="retry-btn">ğŸ”„ é‡æ–°åˆ†æ</button>
                `;
                resultsHeader.querySelector('.retry-btn').onclick = () => {
                    results.style.display = 'none';
                    inputForm.style.display = 'block';
                    inputForm.scrollIntoView({ behavior: 'smooth' });
                };
                content.appendChild(resultsHeader);
                
                // 2. å®šä¹‰åˆ†ç±»ä¿¡æ¯
                const categories = [
                    { key: 'å†²åˆºé™¢æ ¡', name: 'å†²åˆºé™¢æ ¡', class: 'rush' },
                    { key: 'ç¨³å¦¥é™¢æ ¡', name: 'ç¨³å¦¥é™¢æ ¡', class: 'stable' },
                    { key: 'ä¿åº•é™¢æ ¡', name: 'ä¿åº•é™¢æ ¡', class: 'safe' },
                    { key: 'å«åº•é™¢æ ¡', name: 'å…œåº•é™¢æ ¡', class: 'backup' } // "å«åº•"æ”¹ä¸º"å…œåº•"ï¼Œå¬èµ·æ¥æ›´ç§¯æ
                ];
                
                // 3. å¾ªç¯åˆ›å»ºæ¯ä¸ªåˆ†ç±»å¡ç‰‡
                categories.forEach(category => {
                    const categoryData = data[category.key];
                    if (!categoryData) return;

                    const categoryCard = document.createElement('div');
                    categoryCard.className = 'category-card';
                    
                    let cardContent = `
                        <div class="category-header ${category.class}">
                            ${category.name}
                        </div>
                        <div class="category-content">
                    `;
                    
                    const localSchools = categoryData['çœå†…'] || [];
                    const externalSchools = categoryData['çœå¤–'] || [];

                    if (localSchools.length > 0 || externalSchools.length > 0) {
                        cardContent += `<div class="schools-container">
                            <div class="local-schools">
                                <h4>çœå†…é™¢æ ¡</h4>
                                ${localSchools.length > 0 ? createSchoolTable(localSchools) : '<p>æš‚æ— æ¨èé™¢æ ¡</p>'}
                            </div>
                            <div class="external-schools">
                                <h4>çœå¤–é™¢æ ¡</h4>
                                ${externalSchools.length > 0 ? createSchoolTable(externalSchools) : '<p>æš‚æ— æ¨èé™¢æ ¡</p>'}
                            </div>
                        </div>`;
                        
                    }
                    if (localSchools.length === 0 && externalSchools.length === 0) {
                        cardContent += `<p class="no-data">æš‚æ— æ­¤åˆ†ç±»ä¸‹çš„é™¢æ ¡æ¨è</p>`;
                    }

                    cardContent += `</div>`;
                    categoryCard.innerHTML = cardContent;
                    content.appendChild(categoryCard);
                });

                hideLoading();
                inputForm.style.display = 'none'; // éšè—è¡¨å•
                results.style.display = 'block';
                // [ä¼˜åŒ–] å¹³æ»‘æ»šåŠ¨åˆ°ç»“æœåŒºåŸŸ
                results.scrollIntoView({ behavior: 'smooth' });
                
            } catch (error) {
                console.error('è§£ææˆ–å±•ç¤ºç»“æœæ—¶å‡ºé”™:', error);
                showError('AIè¿”å›ç»“æœæ ¼å¼æœ‰è¯¯ï¼Œæ— æ³•è§£æã€‚è¯·å°è¯•è°ƒæ•´è¾“å…¥åé‡è¯•ã€‚');
            }
        }
        
        // [æ–°å¢] è¾…åŠ©å‡½æ•°ï¼Œç”¨äºåˆ›å»ºå­¦æ ¡è¡¨æ ¼HTML
        function createSchoolTable(schools) {
            let tableHTML = `
                <table class="school-table">
                    <thead>
                        <tr>
                            <th style="width: 30%;">é™¢æ ¡åç§°</th>
                            <th>ç®€è¦è¯´æ˜</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            schools.forEach(school => {
                tableHTML += `
                    <tr>
                        <td class="school-name" data-label="é™¢æ ¡åç§°">${school.name || 'N/A'}</td>
                        <td class="school-desc" data-label="ç®€è¦è¯´æ˜">${school.description || 'æš‚æ— è¯´æ˜'}</td>
                    </tr>
                `;
            });
            tableHTML += `</tbody></table>`;
            return tableHTML;
        }

        function showLoading() {
            submitBtn.disabled = true;
            inputForm.style.display = 'none'; // éšè—è¡¨å•
            loading.style.display = 'flex';
            results.style.display = 'none';
            errorMessage.style.display = 'none';
        }
 
        function hideLoading() {
            submitBtn.disabled = false;
            loading.style.display = 'none';
        }
 
        function showError(message) {
            hideLoading();
            errorMessage.textContent = message;
            errorMessage.style.display = 'block';
            inputForm.style.display = 'block'; // å‡ºé”™æ—¶æ˜¾ç¤ºè¡¨å•
            results.style.display = 'none';
        }
    </script>
</body>
</html>